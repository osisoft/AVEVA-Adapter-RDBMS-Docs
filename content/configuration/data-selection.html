<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Data selection </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Data selection ">
    <meta name="generator" content="docfx 2.59.1.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../content/index.html" width="46">
                <img id="logo" src="../../content/main/shared-content/images/atlas_icon.png" height="46" width="46" alt="OSIsoft Edge System"> 
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="PIAdapterForRDBMSDataSelectionConfiguration">
<h1 id="data-selection">Data selection</h1>

<p>In addition to the data source configuration, you need to provide a data selection configuration to specify the data you want the adapter to collect from the data sources.</p>
<p>Each data selection item references a query that returns the value(s) for that item. For more information on queries, see <a class="xref" href="queries.html">PI Adapter for RDBMS queries configuration</a>.</p>
<h2 id="configure-rdbms-data-selection">Configure RDBMS data selection</h2>
<p>Complete the following steps to configure an RDBMS data selection. Use the <code>PUT</code> method in conjunction with the <code>api/v1/configuration/&lt;ComponentId&gt;/DataSelection</code> REST endpoint to initialize the configuration.</p>
<ol>
<li><p>Using a text editor, create an empty text file.</p>
</li>
<li><p>Copy and paste an example configuration for an RDBMS data selection into the file.</p>
<p> For sample JSON, see <a href="#rdbms-data-selection-examples">RDBMS data selection examples</a>.</p>
</li>
<li><p>Update the example JSON parameters for your environment.</p>
<p> For a table of all available parameters, see <a href="#rdbms-data-selection-parameters">RDBMS data selection parameters</a>.</p>
</li>
<li><p>Save the file. For example, as <code>ConfigureDataSelection.json</code>.</p>
</li>
<li><p>Open a command line session. Change directory to the location of <code>ConfigureDataSelection.json</code>.</p>
</li>
<li><p>Enter the following cURL command (which uses the <code>PUT</code> method) to initialize the data selection configuration.</p>
<pre><code class="lang-bash">curl -d &quot;@ConfigureDataSelection.json&quot; -H &quot;Content-Type: application/json&quot; -X PUT &quot;http://localhost:5590/api/v1/configuration/RDBMS1/DataSelection&quot;
</code></pre><p> <strong>Notes:</strong></p>
<ul>
<li>If you installed the adapter to listen on a non-default port, update <code>5590</code> to the port number in use.</li>
<li>If you use a component Id other than <code>RDBMS1</code>, update the endpoint with your chosen component Id.</li>
<li>For a list of other REST operations you can perform, like updating or deleting a data selection configuration, see <a href="#rest-urls">REST URLs</a>.
<br>
<br></li>
</ul>
</li>
</ol>
<h2 id="rdbms-data-selection-schema">RDBMS data selection schema</h2>
<p>The full schema definition for the RDBMS data selection configuration is in the <code>RDBMS_DataSelection_schema.json</code> file located in one of the following folders:</p>
<p>Windows: <code>%ProgramFiles%\OSIsoft\Adapters\RDBMS\Schemas</code></p>
<p>Linux: <code>/opt/OSIsoft/Adapters/RDBMS/Schemas</code></p>
<h2 id="rdbms-data-selection-parameters">RDBMS data selection parameters</h2>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DataFilterId</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>The identifier of a data filter defined in the <a class="xref" href="../main/shared-content/configuration/data-filters.html">Data filters configuration</a>. By default, no filter is applied.<br><strong>Note:</strong> If the specified <strong>DataFilterId</strong> does not exist, unfiltered data is sent until that <strong>DataFilterId</strong> is created.</td>
</tr>
<tr>
<td><strong>ValueColumn</strong></td>
<td>Required<sup>1</sup></td>
<td><code>string</code></td>
<td>The database column to read data values from.</td>
</tr>
<tr>
<td><strong>IndexColumn</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>Column that contains the timestamp. If no column is specified, the timestamp will be the time that the adapter read the value.</td>
</tr>
<tr>
<td><strong>SelectColumn</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>Name of the column that contains the SelectValue. Used to identify which rows of the query results belong to the selection item.</td>
</tr>
<tr>
<td><strong>SelectValue</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>The unique identifier of the source. This identifier is commonly found in the database column specified in <strong>SelectColumn</strong>. Used to identify which rows of the query results belong to the selection item.</td>
</tr>
<tr>
<td><strong>Name</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>The friendly name of the data item collected from the data source. If not configured, the default value is the stream Id.</td>
</tr>
<tr>
<td><strong>QueryId</strong></td>
<td>Required</td>
<td><code>string</code></td>
<td>The identifier of the query configured.</td>
</tr>
<tr>
<td><strong>ScheduleId</strong></td>
<td>Required</td>
<td><code>string</code></td>
<td>The identifier of a schedule defined in the Schedules configuration.</td>
</tr>
<tr>
<td><strong>Selected</strong></td>
<td>Optional</td>
<td><code>boolean</code></td>
<td>If <code>true</code>, data for this item is collected and sent to one or more configured OMF endpoints.<br><br>Allowed value: <code>true</code> or <code>false</code><br>Default value:<code>true</code></td>
</tr>
<tr>
<td><strong>StreamId</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>The custom identifier used to create the stream. If not specified, the RDBMS adapter generates a default value based on the <strong>DefaultStreamIdPattern</strong> in the <a class="xref" href="data-source.html">PI Adapter for RDBMS data source configuration</a>.<br><br>For more information on how the adapter encodes special characters in the <strong>StreamId</strong>, see <a class="xref" href="../main/shared-content/configuration/egress-endpoints.html#special-characters-encoding">Egress endpoints</a>.</td>
</tr>
<tr>
<td><strong>DataColumns</strong></td>
<td>Required<sup>1</sup></td>
<td><code>dictionary&lt;string, string&gt;</code></td>
<td>A dictionary of values with key-value pairs. The keys are specific fields for a complex type and the values are the database column to read data values from.<br><br>Allowed keys: <code>Latitude</code>, <code>Longitude</code>, <code>x</code>, <code>y</code>, <code>z</code><br>Default value: <code>null</code></td>
</tr>
</tbody>
</table>
<p><sup>1</sup> <strong>ValueColumn</strong> and <strong>DataColumns</strong> are mutually exclusive. For example, if you specify <strong>ValueColumn</strong>, you cannot specify <strong>DataColumns</strong> and vice versa.</p>
<h2 id="rdbms-data-selection-examples">RDBMS data selection examples</h2>
<p>There are two ways to configure a selection item.</p>
<ul>
<li><strong>By Column:</strong> Uniquely identify a stream using the columns from the result set. This method is simplest.</li>
<li><strong>By Row:</strong> Uniquely identify a stream using the rows from the result set. This method is more complex, but more common.</li>
</ul>
<p>The following sections contain examples of valid RDBMS data selection configurations.</p>
<h3 id="column-as-an-identifier">Column as an identifier</h3>
<p>Use this configuration when you have a table whose columns identify each stream in the result set. In the simplest of cases, there is one value column and one timestamp column; however, there could be multiple values and multiple timestamps. A separate data selection item needs to be defined for each timestamp value pair.</p>
<p>Example data:</p>
<table>
<thead>
<tr>
<th>Temperature</th>
<th>Pressure</th>
<th>Volume</th>
<th>SampleTime</th>
</tr>
</thead>
<tbody>
<tr>
<td>25</td>
<td>100</td>
<td>50.6</td>
<td>11/11/2020 3:56:00 AM</td>
</tr>
<tr>
<td>26.3</td>
<td>100.2</td>
<td>50.7</td>
<td>11/11/2020 3:26:00 AM</td>
</tr>
</tbody>
</table>
<p>Temperature:</p>
<pre><code class="lang-json">[
  {
    &quot;StreamId&quot;: &quot;Tank1.Temperature&quot;,
    &quot;ValueColumn&quot;: &quot;Temperature&quot;,
    &quot;IndexColumn&quot;: &quot;SampleTime&quot;,
    &quot;ScheduleId&quot;: &quot;1min&quot;,
    &quot;QueryId&quot;: &quot;Tank1&quot;,
    &quot;Selected&quot;: true
  }
]
</code></pre><p>Pressure:</p>
<pre><code class="lang-json">[
  {
    &quot;StreamId&quot;: &quot;Tank1.Pressure&quot;,
    &quot;ValueColumn&quot;: &quot;Pressure&quot;,
    &quot;IndexColumn&quot;: &quot;SampleTime&quot;,
    &quot;ScheduleId&quot;: &quot;1min&quot;,
    &quot;QueryId&quot;: &quot;Tank1&quot;,
    &quot;Selected&quot;: true
  }
]
</code></pre><p>Volume:</p>
<pre><code class="lang-json">[
  {
    &quot;StreamId&quot;: &quot;Tank1.Volume&quot;,
    &quot;ValueColumn&quot;: &quot;Volume&quot;,
    &quot;IndexColumn&quot;: &quot;SampleTime&quot;,
    &quot;ScheduleId&quot;: &quot;1min&quot;,
    &quot;QueryId&quot;: &quot;Tank1&quot;,
    &quot;Selected&quot;: true
  }
]
</code></pre><p>Example complex data:</p>
<table>
<thead>
<tr>
<th>Lat</th>
<th>Lon</th>
<th>X_Col</th>
<th>Y_Col</th>
<th>Z_Col</th>
</tr>
</thead>
<tbody>
<tr>
<td>15.294533</td>
<td>20.479839</td>
<td>1.1</td>
<td>2.2</td>
<td>3.3</td>
</tr>
<tr>
<td>36.33403</td>
<td>-82.4019478</td>
<td>4.1</td>
<td>5.2</td>
<td>6.4</td>
</tr>
<tr>
<td>35.53565</td>
<td>-82.5529333333333</td>
<td>7.1</td>
<td>8.2</td>
<td>9.3</td>
</tr>
</tbody>
</table>
<p>Coordinates and Geolocation:</p>
<pre><code class="lang-json">[    
  {        
    &quot;StreamId&quot;: &quot;ComplexQuery.Coordinates&quot;,        
    &quot;DataColumns&quot;: {            
        &quot;X&quot;: &quot;X_Col&quot;,            
        &quot;Y&quot;: &quot;Y_Col&quot;,            
        &quot;Z&quot;: &quot;Z_Col&quot;        
    },        
    &quot;ScheduleId&quot;: &quot;1&quot;,        
    &quot;queryId&quot;: &quot;ComplexQuery&quot;,        
    &quot;Selected&quot;: true    
  },    
  {        
    &quot;StreamId&quot;: &quot;ComplexQuery.Geolocation&quot;,        
    &quot;DataColumns&quot;: {            
        &quot;Latitude&quot;: &quot;Lat&quot;,            
        &quot;Longitude&quot;: &quot;Lon&quot;        
    },        
    &quot;ScheduleId&quot;: &quot;1&quot;,        
    &quot;queryId&quot;: &quot;ComplexQuery&quot;,        
    &quot;Selected&quot;: true    
  }
]
</code></pre><h3 id="identifier-in-row">Identifier in Row</h3>
<p>Use this configuration when each row of the result set contains information needed to identify each stream. In the simplest case, there could be one column for the identifier, one column for the timestamp, and one column for the value. However, result sets could contain multiple timestamp columns and multiple value columns. This configuration requires that the user specify the SelectColumn and SelectValue properties.</p>
<p>Example Data:</p>
<table>
<thead>
<tr>
<th>Asset</th>
<th>Temperature</th>
<th>Pressure</th>
<th>Volume</th>
<th>SampleTime</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tank1</td>
<td>25</td>
<td>100</td>
<td>50.6</td>
<td>11/11/2020 3:56:00 AM</td>
</tr>
<tr>
<td>Tank2</td>
<td>26.3</td>
<td>100.2</td>
<td>50.7</td>
<td>11/11/2020 3:56:00 AM</td>
</tr>
<tr>
<td>Tank3</td>
<td>26.4</td>
<td>100.1</td>
<td>50.5</td>
<td>11/11/2020 3:56:00 AM</td>
</tr>
<tr>
<td>Tank2</td>
<td>26.5</td>
<td>100</td>
<td>50.4</td>
<td>11/11/2020 3:46:00 AM</td>
</tr>
<tr>
<td>Tank3</td>
<td>26.6</td>
<td>99.9</td>
<td>50.3</td>
<td>11/11/2020 3:46:00 AM</td>
</tr>
<tr>
<td>Tank1</td>
<td>26.7</td>
<td>99.8</td>
<td>50.2</td>
<td>11/11/2020 3:46:00 AM</td>
</tr>
</tbody>
</table>
<p>Tank1.Temperature:</p>
<pre><code class="lang-json">[
  {
    &quot;StreamId&quot;: &quot;Tank1.Temperature&quot;,
    &quot;ValueColumn&quot;: &quot;Temperature&quot;,
    &quot;IndexColumn&quot;: &quot;SampleTime&quot;,
    &quot;SelectColumn&quot;: &quot;Asset&quot;,
    &quot;SelectValue&quot;: &quot;Tank1&quot;,
    &quot;ScheduleId&quot;: &quot;1min&quot;,
    &quot;QueryId&quot;: &quot;Tanks&quot;,
    &quot;Selected&quot;: true
  }
]
</code></pre><p>Tank2.Temperature:</p>
<pre><code class="lang-json">[
  {
    &quot;StreamId&quot;: &quot;Tank2.Temperature&quot;,
    &quot;ValueColumn&quot;: &quot;Temperature&quot;,
    &quot;IndexColumn&quot;: &quot;SampleTime&quot;,
    &quot;SelectColumn&quot;: &quot;Asset&quot;,
    &quot;SelectValue&quot;: &quot;Tank2&quot;,
    &quot;ScheduleId&quot;: &quot;1min&quot;,
    &quot;QueryId&quot;: &quot;Tanks&quot;,
    &quot;Selected&quot;: true
  }
]
</code></pre><h2 id="rest-urls">REST URLs</h2>
<table>
<thead>
<tr>
<th>Relative URL</th>
<th>HTTP verb</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection</td>
<td><code>GET</code></td>
<td>Retrieves the data selection configuration, including all data selection items.</td>
</tr>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection</td>
<td><code>PUT</code></td>
<td>Configures or updates the data selection configuration. The adapter starts collecting data for each data selection item when the following conditions are met:<br><br>&bull; The data selection configuration <code>PUT</code> request is received.<br>&bull; A data source configuration is active.</td>
</tr>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection</td>
<td><code>DELETE</code></td>
<td>Deletes the active data selection configuration. The adapter stops collecting data.</td>
</tr>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection</td>
<td><code>PATCH</code></td>
<td>Allows partial updates of configured data selection items.<br><br><strong>Note:</strong> The request must be an array containing one or more data selection items. Each item in the array must include its <strong>StreamId</strong>.</td>
</tr>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection/&lt;StreamId></td>
<td><code>PUT</code></td>
<td>Updates or creates a new data selection item by <strong>StreamId</strong>. For new items, the adapter starts collecting data after the request is received.</td>
</tr>
<tr>
<td>api/v1/configuration/&lt;ComponentId>/DataSelection/&lt;StreamId></td>
<td><code>DELETE</code></td>
<td>Deletes a data selection item from the configuration by <strong>StreamId</strong>. The adapter stops collecting data for the deleted item.</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> Replace &lt;ComponentId> with the Id of your RDBMS component, for example RDBMS1.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/osisoft/PI-Adapter-RDBMS-Docs/blob/main/content/configuration/data-selection.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span><a href="https://www.osisoft.com/copyright/">© 2019 - 2021 OSIsoft, LLC. All rights reserved.</a></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
